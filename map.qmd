---
title: "Mapa de Miembros"
---

``` {r echo = F , message = FALSE, warning = F}
library(dplyr)
library(leaflet)
library(sf)
library(htmltools)
source("R/map_functions.R")



member.table <- gsheet::gsheet2tbl("1tRlCcIxurHIDg-CCHsFFbkD3e4YkiDlA3PkFlTcBlk8") |>
  format_member_table()

coords.table <- readr::read_csv("institutioncoords.csv") |> 
  update_coord_table(member.table= member.table)
readr::write_csv(coords.table, "institutioncoords.csv")

member.table.coords <- left_join(member.table, coords.table) |> 
  filter(!is.na(lon)) |> 
  st_as_sf(coords = c("lon", "lat"))


leaflet(member.table.coords) |> 
  addTiles() |> 
  addMarkers(popup = points, 
             label = ~(Nombre),
             labelOptions = labelOptions(zoomAnimation = T),
             clusterOptions = markerClusterOptions())
   #addProviderTiles(Esri.WorldGrayCanvas")
  
  
```